(function(){var head=document.getElementsByTagName("head")[0];var loadScript=function(url,async,next){var script=document.createElement("script");script.charset="UTF-8";script.async=async;script.onerror=function(){next&&next(true)};var loaded=false;script.onload=script.onreadystatechange=function(){if(!loaded&&(!script.readyState||"loaded"===script.readyState||"complete"===script.readyState)){loaded=true;setTimeout(function(){next&&next(false)},0)}};script.src=url;head.appendChild(script)};var loadCss=function(url,next){var style=document.createElement("link");style.href=url;style.rel="stylesheet";style.type="text/css";style.onerror=function(){next&&next(true)};var loaded=false;style.onload=style.onreadystatechange=function(){if(!loaded&&(!style.readyState||"loaded"===style.readyState||"complete"===style.readyState)){loaded=true;setTimeout(function(){next&&next(false)},0)}};head.appendChild(style)};var environment="pro";var version="1.7.7";var staticTimestamp=((new Date).getTime()/36e5).toFixed(0);switch(environment){case"dev":if(_fmOpt.tdDebug==undefined)_fmOpt.tdDebug=true;var devHost="http://localhost:3004";_fmOpt.cpHost="http://10.57.243.243:8088";staticTimestamp=(new Date).getTime();break;case"test":if(_fmOpt.tdDebug==undefined)_fmOpt.tdDebug=true;_fmOpt.cpHost="http://10.57.243.243:8088";staticTimestamp=(new Date).getTime();break;case"stg":_fmOpt.env=1;_fmOpt.cpHost="https://sphinxstg.tongdun.net";staticTimestamp=(new Date).getTime();break;default:break}var sphinxHost=_fmOpt.sphinxHost?_fmOpt.sphinxHost:_fmOpt.env==0?"https://sphinxtest.tongdun.net":"https://sphinx.tongdun.net";if(_fmOpt.env===0){_fmOpt.fpHost="https://fptest.fraudmetrix.cn"}var fpHost=_fmOpt.fpHost?_fmOpt.fpHost:_fmOpt.env==0?"https://fptest.fraudmetrix.cn":"https://fp.tongdun.net";var staticHost=_fmOpt.env==0?"https://statictest.tongdun.net":"https://static.tongdun.net";if(!_fmOpt.webview){loadScript(staticHost+"/v3/fm.js?t="+staticTimestamp,false);if(!_fmOpt.imgLoaded){var cimg=new Image(1,1);cimg.onload=function(){_fmOpt.imgLoaded=true};cimg.src=fpHost+"/fp/clear.png?partnerCode="+_fmOpt.partner+"&appName="+_fmOpt.appName+"&tokenId="+_fmOpt.token}var cimg2=new Image(1,1);cimg2.src=sphinxHost+"/sphinx/loadcount/v1?partnerCode="+_fmOpt.partner+"&appName="+_fmOpt.appName+"&loadType=1&sessionId="+_fmOpt.token+"&collectTime="+_fmOpt.initialTime}switch(environment){case"dev":loadCss(devHost+"/src/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(devHost+"/src/tdCaptcha.js?t="+staticTimestamp,true)}});break;case"test":loadCss(staticHost+"/cadev/captcha/main/"+version+"/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(staticHost+"/cadev/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true)}});break;case"stg":loadCss(staticHost+"/castg/captcha/main/"+version+"/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(staticHost+"/castg/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true)}});break;case"pro":loadCss(staticHost+"/captcha/main/"+version+"/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true)}});break;case"sand":loadCss(staticHost+"/captcha/main/"+version+"/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true)}});break;default:loadCss(staticHost+"/captcha/main/"+version+"/tdCaptcha.css?t="+staticTimestamp,function(){if(_fmOpt.webview){loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true)}});break}if(!_fmOpt.webview){switch(environment){case"dev":loadScript(devHost+"/src/tdCaptcha.js?t="+staticTimestamp,true);break;case"test":loadScript(staticHost+"/cadev/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true);break;case"stg":loadScript(staticHost+"/castg/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true);break;case"pro":loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true);break;case"sand":loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true);break;default:loadScript(staticHost+"/captcha/main/"+version+"/tdCaptcha.js?t="+staticTimestamp,true);break}}if(_fmOpt.tdDebug){loadScript("https://portal-static.tongdun.cn/static-public/seed/mobile-utils/1.0.0/js/vconsole.min.js",true,function(){window.vConsole=new window.VConsole;console.log("验证码当前环境:",environment);console.log("验证码当前版本:",version)})}})();